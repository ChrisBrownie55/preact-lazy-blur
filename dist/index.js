!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("preact"),require("preact-waypoint")):"function"==typeof define&&define.amd?define(["preact","preact-waypoint"],e):t.PreactLazyBlur=e(t.preact,t.Waypoint)}(this,function(t,e){"use strict";return e=e&&e.hasOwnProperty("default")?e.default:e,function(t){function i(e){t.call(this,e),this.state={waypoint:!1,image:{transition:"opacity",transitionDuration:this.props.duration+"ms",opacity:0},imageSource:"",blur:{transition:"opacity",transitionDuration:this.props.duration+"ms",opacity:1,filter:"blur(50%)"},blurSource:this.props.blur,loaded:!1}}return t&&(i.__proto__=t),((i.prototype=Object.create(t&&t.prototype)).constructor=i).prototype.componentWillMount=function(){this.setState({imageSource:this.props.blur})},i.prototype.shouldComponentUpdate=function(t,e){return this.state.waypoint===e.waypoint||e.loading||e.loaded||this.lazy(),!0},i.prototype.lazy=function(){var t=this,e=this.props.image,i=this.props.duration||500,o=this,a=new Image;a.onload=function(){o.setState({blur:{transition:"opacity "+i+"ms",opacity:1},image:{transition:"opacity "+i+"ms",opacity:0},imageSource:a.src}),requestAnimationFrame(function(){o.setState({blur:Object.assign({},t.state.blur,{opacity:0}),image:Object.assign({},t.setState.image,{opacity:1})}),setTimeout(function(){return o.setState({loaded:!0})},i)})},a.src=e},i.prototype.render=function(){var t=this,i=this.props,o=i.children,a=i.style;void 0===a&&(a={});var r=i.containerStyle;void 0===r&&(r={});var n=this.state,s=n.image,c=n.imageSource,p=n.blur,u=n.blurSource,l="react-lazy-blur "+(this.props.className||""),y=Object.assign({},{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover"},a);return h("div",{className:l,style:Object.assign({},{position:"relative"},r)},h(e,{onEnter:function(){return t.setState({waypoint:!0})}}),h("img",{className:"react-lazy-blur image",src:c,style:Object.assign({},s,y)}),this.state.loaded?null:h("img",{className:"react-lazy-blur blur",src:u,style:Object.assign({},p,y)}),o,h(e,{onEnter:function(){return t.setState({waypoint:!0})}}))},i}(t.Component)});